!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(1),i=r(o);window.Collux=i.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=r(o),a=n(3),u=r(a),s=n(21),c=r(s),f=n(22),l=r(f),p=n(23),h=r(p),y=n(27),d=r(y),v=n(28),_=r(v),m=n(40),b=r(m),g=n(4),w=r(g);t.default={App:i.default,Component:u.default,StoreComponent:d.default,ViewComponent:_.default,Link:b.default,Constants:c.default,createApp:l.default,registerArch:h.default.register,use:function(e){w.default.use(e)}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(3),u=r(a),s=n(4),c=r(s),f=function(){function e(){o(this,e),this._components=new Map}return i(e,[{key:"override",value:function(e,t,n){return["actuator.sync","actuator.async","processor.sync","processor.async","filter"].indexOf(t)<0?void console.warn("Unsupported registry type",t,"for node",e):void c.default.registry.register(e,t,n)}},{key:"addComponent",value:function(e){this._components.set(e.name,e)}},{key:"createComponent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.arch||(n.arch=e),t||(t=e);var r=new u.default(e,t,n);return this._components.set(e,r),r}},{key:"hasComponent",value:function(e){return this._components.has(e)}},{key:"getComponentByName",value:function(e){return this._components.get(e)}},{key:"initComponents",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this._components.values()[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;i.init()}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}},{key:"connectCompnents",value:function(){}},{key:"startComponents",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this._components.values()[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;i.start()}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}},{key:"run",value:function(){this.initComponents(),this.connectComponents(),this.startComponents()}}]),e}();t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(4),u=r(a),s=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o(this,e),this.name=t||e.getDefaultComponentName(),this.namespace=n||this.name,this.metadata=r,this.metadata.arch||(this.metadata.arch=t),this._ns=u.default.ns(this.namespace,this.metadata),this._input=this._ns.input("@input "+this.name+".input"),this._output=this._ns.output("@output "+this.name+".output"),this._handleMsg=u.default.toNode(this._input,this._output)}return i(e,[{key:"ns",value:function(){return this._ns}},{key:"input",value:function(){return this._input}},{key:"output",value:function(){return this._output}},{key:"handleMsg",value:function(e,t){return this._handleMsg(e,t)}},{key:"init",value:function(){}},{key:"start",value:function(){}}],[{key:"getDefaultComponentName",value:function(){return e.__COUNT__++,"component_"+e.__COUNT__}}]),e}();s.__COUNT__=0,t.default=s},function(e,t,n){e.exports=n(5)},function(e,t,n){(function(t){!function(t,r){e.exports=r(n(9),n(14),n(20))}(this,function(e,r,o){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":r(e)},i=n(1),a=n(7),u=null,s=[];u||(u=i(a),u.use=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var f=a.value;s.push(f),u.extend({observers:f.observers()}),f.run()}}catch(e){o=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}return u},u.ns=function(e,t){t&&"object"===("undefined"==typeof t?"undefined":o(t))||(t={}),t.namespace=e;var n=i(a.new(t)),r=!0,u=!1,c=void 0;try{for(var f,l=s[Symbol.iterator]();!(r=(f=l.next()).done);r=!0){var p=f.value;n.extend({observers:p.observers()}),p.run()}}catch(e){u=!0,c=e}finally{try{!r&&l.return&&l.return()}finally{if(u)throw c}}return n},u.module=function(e,t,n){n&&"object"===("undefined"==typeof n?"undefined":o(n))||(n={}),n.module=e,t&&"string"==typeof t||(t=e);var r=u.ns(t,n),i=r.input(e+" input"),a=r.output(e+" output");return{ns:function(){return r},in:function(){return i},out:function(){return a},handleMsg:u.toNode(i,a)}}),e.exports=u},function(e,t,n){"use strict";var r=n(2),o=n(11),i=n(16),a=n(17),u=n(20),s=n(21),c=n(22),f=n(23),l=n(15),p=n(24),h=n(25),y=n(26),d=n(28),v=n(29),_=n(30),m=n(31),b=n(32),g=n(33),w=n(34),S=n(19),O=n(18),k={others:{Node:r,Signal:o,registry:S,toNode:O.toNode}},E=[i,a,u,s,f,c,l,p,h,y,d,v,_,m,b,g,w,k];e.exports=function(e){var t=e;return E.forEach(function(e){t=t.extend(e)}),t}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){if(e){var t=e.match(/@(\w+)/);if(null!=t)return t[1]}}function u(e){if(!e)return[];for(var t=/#(\w+)/g,n=[],r=null;null!==(r=t.exec(e));)n.push(r[1]);return n}function s(e){if(!e)return{};var t=a(e),n=u(e),r=e.replace(/@(\w+)/g,"").replace(/#(\w+)/g,"").replace(/^(\s+)/g,"");return{name:t,tags:n,comment:r}}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},p=n(3),h=n(11),y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));i._type="node";var a=s(e.comment);return i._name=a.name||i.id,i._comment=a.comment,i._inputs=e.inputs||{},i._outputs=e.outputs||{},i._features=e.features||[],i._tags=a.tags,e.todo&&i.addFeature("todo"),i}return i(t,e),f(t,[{key:"addFeature",value:function(e){return this._features.indexOf(e)<0&&this._features.push(e),this}},{key:"removeFeature",value:function(e){var t=this._features.indexOf(e);return t>=0&&this._features.splice(t,1),this}},{key:"getFeatures",value:function(){return this._features}},{key:"hasFeature",value:function(e){return this._features.indexOf(e)>=0}},{key:"getState",value:function(e,t){t()}},{key:"onSignal",value:function(e){var t=this;return this.accept(e)?(this.act(e,function(e,t){if(e)throw e}),this.process(e,function(e,n){if(e)throw e;t.send(n)}),this):(this.request(),this)}},{key:"send",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e;return h.isSignal(e)||(r=new h(e)),n===!1&&(r=r.setTag("__non_interruptible__",!0)),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,r,n)}},{key:"push",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e;return h.isSignal(e)||(r=new h(e)),n===!1&&(r=r.setTag("__non_interruptible__",!0)),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"push",this).call(this,r,n)}},{key:"watch",value:function(e){}},{key:"accept",value:function(e){return!0}},{key:"act",value:function(e,t){t()}},{key:"process",value:function(e,t){t(null,e)}},{key:"onRequest",value:function(e){return this.onNext(e),this}},{key:"onNext",value:function(e){this.request(e)}},{key:"isInterruptibleSignal",value:function(e){return!e.getTag("__non_interruptible__")}},{key:"isErrorSignal",value:function(e){return h.isSignal(e)&&h.hasError(e)}},{key:"isEndSignal",value:function(e){return h.isSignal(e)&&h.isEnd(e)}},{key:"throwError",value:function(e,t){return this.send(t.setError(e))}},{key:"through",value:function e(r,o,i){var a=this,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=null;"string"!=typeof r?(u=i,i=o,o=r,s=o._comment):(s=o._comment,o._comment=r),i||(i=o);var c=!0;if(Object.keys(this.meta).length===Object.keys(o.meta).length){var f=!0,p=!1,h=void 0;try{for(var y,d=Object.keys(this.meta)[Symbol.iterator]();!(f=(y=d.next()).done);f=!0){var v=y.value;if("namespace"!==v&&this.meta[v]!==o.meta[v]){c=!1;break}}}catch(e){p=!0,h=e}finally{try{!f&&d.return&&d.return()}finally{if(p)throw h}}if(o.id!==i.id&&Object.keys(this.meta).length===Object.keys(i.meta).length){var _=!0,m=!1,b=void 0;try{for(var g,w=Object.keys(this.meta)[Symbol.iterator]();!(_=(g=w.next()).done);_=!0){var S=g.value;if("namespace"!==S&&this.meta[S]!==i.meta[S]){c=!1;break}}}catch(e){m=!0,b=e}finally{try{!_&&w.return&&w.return()}finally{if(m)throw b}}}}else c=!1;if(c)return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"to",this).call(this,o),i?i:o;var e=n(15).through,O=e(o._comment,o,i,u);return o._comment=s,Object.keys(this.meta).forEach(function(e){Object.prototype.hasOwnProperty.call(a.meta,e)&&(Object.prototype.hasOwnProperty.call(o.meta,e)||o.preventMetaPropagation()||(o.meta[e]=a.meta[e]),O.meta[e]=a.meta[e])}),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"to",this).call(this,O)}},{key:"to",value:function(e,n){var r=this;if("string"==typeof e){if(n._comment=e,!n)return this}else if(n=e,!n)return this;return Object.keys(this.meta).forEach(function(e){Object.prototype.hasOwnProperty.call(r.meta,e)&&(Object.prototype.hasOwnProperty.call(n.meta,e)||n.preventMetaPropagation()||(n.meta[e]=r.meta[e]))}),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"to",this).call(this,n)}},{key:"preventMetaPropagation",value:function(){return!1}},{key:"getTags",value:function(){return this._tags}},{key:"hasTag",value:function(e){return this._tags.indexOf(e)>=0}},{key:"addTag",value:function(e){this._tags.push(e)}},{key:"delTag",value:function(e){var t=this._tags.indexOf(e);t>=0&&this._tags.splice(t,1)}},{key:"getMeta",value:function(){return this.meta}},{key:"getMetaByName",value:function(e){return this.meta[e]}},{key:"addMeta",value:function(e,t){this.meta[e]=t}},{key:"getNamespace",value:function(){return this.meta.namespace}},{key:"toJSON",value:function(){return{id:this.id,name:this.name,namespace:this.namespace,fullName:this.fullName,features:this.getFeatures(),meta:this.meta,tags:this.tags,comment:this.comment,inputs:this.inputs,outputs:this.outputs}}},{key:"name",get:function(){return this._name}},{key:"fullName",get:function(){return this.meta.namespace?this.meta.namespace+"."+this._name:this._name}},{key:"tags",get:function(){return this._tags}},{key:"namespace",get:function(){return this.getNamespace()}},{key:"comment",get:function(){return this._comment}},{key:"type",get:function(){return this._type}},{key:"inputs",get:function(){return this._inputs},set:function(e){var t=this;return Array.isArray(e)?e.forEach(function(e){t._inputs[e]=""}):this._inputs=e,this}},{key:"outputs",get:function(){return this._outputs},set:function(e){var t=this;return Array.isArray(e)?e.forEach(function(e){t._outputs[e]=""}):this._outputs=e,this}}]),t}(p);e.exports=y},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4),a=i.uuid,u=i.EventEmitter,s=i.setImmediate,c=function(){function e(t,n){r(this,e),this.id=a.v1(),this.options=t,e.shareEE?this.ee=e.ee:this.ee=n||new u,this.obs=[],this.ups={},this.downs={},this.meta={}}return o(e,[{key:"push",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n!==!1&&this.isInterruptibleSignal(e)?(s(function(){t.onReceive(e)}),this):(this.onReceive(e),this)}},{key:"onReceive",value:function(e){if(this.invokeObservers("onReceive",e),this.isErrorSignal(e))this.onError(e),this.request();else if(this.isEndSignal(e))try{this.onEnd(e)}catch(t){this.throwError(t,e)}else try{this.onSignal(e)}catch(t){this.throwError(t,e)}return this}},{key:"onSignal",value:function(e){return this.send(e),this}},{key:"onError",value:function(e){return this.send(e),this}},{key:"onEnd",value:function(e){return this.send(e),this}},{key:"send",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.invokeObservers("send",e),n!==!1&&this.isInterruptibleSignal(e)?(s(function(){t.ee.emit("outgoing-"+t.id,e)}),this):(Object.keys(this.downs).forEach(function(n){t.downs[n].onReceive(e)}),this)}},{key:"observe",value:function(e){return this.obs.push(e),this}},{key:"to",value:function(e){var t=this;return this.invokeObservers("to",e),this.downs[e.id]=e,this.ee.on("outgoing-"+this.id,function(t){e.push(t)}),e.ee.on("request-"+e.id,function(e){t.pull(e)}),e.from(this),e}},{key:"pull",value:function(e){var t=this;return s(function(){t.onRequest(e)}),this}},{key:"onRequest",value:function(e){return this.invokeObservers("onRequest",e),this.request(e),this}},{key:"request",value:function(e){var t=this;return this.invokeObservers("request",e),s(function(){t.ee.emit("request-"+t.id,e)}),this}},{key:"from",value:function(e){return this.ups[e.id]=e,this.invokeObservers("from",e),this}},{key:"isInterruptibleSignal",value:function(e){return!0}},{key:"isErrorSignal",value:function(e){return e instanceof Error}},{key:"isEndSignal",value:function(t){return t===e.END}},{key:"throwError",value:function(e,t){return e.signal=t,this.send(e)}},{key:"invokeObservers",value:function(e){for(var t=this,r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];o.unshift(e),o.unshift(this);try{!function(){var e=n(7).observers;Object.keys(e).forEach(function(n){e[n].apply(t,o)}),t.obs.forEach(function(e){e.apply(t,o)})}()}catch(e){console.error(e.message)}}}]),e}();c.shareEE=!1,c.ee=new u,c.END="__SIGNAL_END__",e.exports=c},function(e,n,r){"use strict";var o=r(5),i=r(6);e.exports={uuid:o,EventEmitter:i,setImmediate:t}},function(e,t){e.exports=n(9)},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e),this.listeners={}}return r(e,[{key:"on",value:function(e,t){Object.prototype.hasOwnProperty.call(this.listeners,e)||(this.listeners[e]=[]);var n=this.listeners[e];n.push(t)}},{key:"emit",value:function(e,t){if(Object.prototype.hasOwnProperty.call(this.listeners,e)){var n=this.listeners[e];n.forEach(function(e){return e(t)})}}}]),e}();e.exports=o},function(e,t,n){"use strict";function r(e,t){return Object.assign(t,e)}function o(){function e(e){var t=!0,n=!1,r=void 0;try{for(var o,i=d._indexers.values()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a(e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}function t(t,n){function o(){var t=n.apply(void 0,arguments);return t.meta={},r(this.meta,t.meta),e(t),this.to(t)}return d.reserved.indexOf(t)>=0?(console.warn("can't add operator '"+t+"', name is reserved."),d):(i.prototype[t]=o,d[t]=function(){var t=n.apply(void 0,arguments);return t.meta={},r(d._meta,t.meta),e(t),t},d)}function o(e){Object.keys(e).forEach(function(t){d.addOperator(t,e[t])})}function a(t,n){return d.reserved.indexOf(t)>=0?(console.warn("can't add source '"+t+"', name is reserved. "),d):(d[t]=function(){var t=n.apply(void 0,arguments);return t.meta={},r(d._meta,t.meta),e(t),t},d)}function u(e){return Object.keys(e).forEach(function(t){d.addSource(t,e[t])}),d}function s(e,t){return d[e]=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.query.apply(t,[d].concat(n))},d}function c(e,t){return d._indexers.set(e,function(e){t.index(d,e)}),d}function f(e){var t=e;return"string"==typeof e&&(t=n(8)(e)),t.operators&&d.addOperators(t.operators),t.sources&&d.addSources(t.sources),t.observers&&Object.keys(t.observers).forEach(function(e){d.observers[e]=t.observers[e]}),t.indexers&&Object.keys(t.indexers).forEach(function(e){d.addIndexer(e,t.indexers[e])}),t.queriers&&Object.keys(t.queriers).forEach(function(e){d.addQuerier(e,t.queriers[e])}),t.others&&Object.keys(t.others).forEach(function(e){d[e]=t.others[e]}),d}function l(e){d._meta=e}function p(e,t){d._meta[e]=t}function h(e){d._meta.hasOwnProperty(e)&&delete d._meta[e]}var y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d={};return d._meta=y,d._indexers=new Map,d.Node=i,d.Bouton=i,d.END=i.END,d.reserved=["id","options","ee","observers","upstreams","downstreams","meta","push","onReceive","onSignal","onError","onEnd","send","observe","to","pull","onRequest","request","from","isErrorSignal","isEndSignal","throwError","invokeObservers"],d.addOperator=t,d.addOperators=o,d.addSource=a,d.addSources=u,d.addQuerier=s,d.addIndexer=c,d.observers={},d.extend=f,d.setMeta=l,d.addMeta=p,d.removeMeta=h,d}var i=n(3),a=o();a.new=o,e.exports=a},function(e,t,n){function r(e){return n(o(e))}function o(e){return i[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var i={"./Bouton":3,"./Bouton.js":3,"./dep":4,"./dep.js":4,"./index":7,"./index.js":7,"./operators":9,"./operators.js":9,"./sources":10,"./sources.js":10};r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=8},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":d(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":d(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.fn=e,i}return i(t,e),v(t,[{key:"onSignal",value:function(e){var t=this.fn(e);this.send(t)}}]),t}(_);return new t(e)}function u(e){var t=function(t){function n(e,t){r(this,n);var i=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t));return i.fn=e,i}return i(n,t),v(n,[{key:"onSignal",value:function(t){e(t)?this.send(t):this.request()}}]),n}(_);return new t(e)}function s(e,t){var n=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.memo=i.options.memo,i.iterator=i.options.iterator,i.END=!1,i}return i(t,e),v(t,[{key:"onSignal",value:function(e){this.memo=this.iterator.call(this,this.memo,e),this.request()}},{key:"onEnd",value:function(){this.send(this.memo),this.END=!0}},{key:"onRequest",value:function(e){this.END?this.send(_.END):this.request()}}]),t}(_);return new n({memo:e,iterator:t})}function c(e){var t=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.fn=e,i}return i(t,e),v(t,[{key:"onError",value:function(e){var t=this;this.fn(e,function(e){t.send(e)})}}]),t}(_);return new t(e)}function f(){var e=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),v(t,[{key:"onSignal",value:function(e){this.request()}},{key:"from",value:function(e){this.request()}}]),t}(_);return new e}function l(e){var t=(new Date).getTime(),n=function(n){function a(){return r(this,a),o(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return i(a,n),v(a,[{key:"onSignal",value:function(n){var r=(new Date).getTime();r-e>=t&&(t=r,this.send(n))}}]),a}(_);return new n(e)}function p(e,t){var n=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.n=e.n,i.add=e.add,i}return i(t,e),v(t,[{key:"onSignal",value:function(e){this.n=this.add.call(this,this.n,e),this.send(this.n)}}]),t}(_);return new n({n:e,add:t})}function h(e){var t=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.fn=e,i}return i(t,e),v(t,[{key:"onSignal",value:function(e){this.fn(e),this.send(e)}}]),t}(_);return new t(e)}function y(e){var t=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.fn=e,i}return i(t,e),v(t,[{key:"onEnd",value:function(e){this.fn(e)}}]),t}(_);return new t(e)}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_=n(3);e.exports={operators:{map:a,filter:u,reduce:s,errors:c,sink:f,throttle:l,scan:p,act:h,done:y}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return new l(e)}function u(e){return new p(e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(3),l=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.source=i.options,i.index=0,i}return i(t,e),c(t,[{key:"onRequest",value:function(e){this.source.length===this.index?(this.send(f.END),this.index++):this.source.length>this.index&&(this.send(this.source[this.index]),this.index++)}}]),t}(f),p=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.value=i.options,i.visited=0,i}return i(t,e),c(t,[{key:"onRequest",value:function(e){0==this.visited?(this.send(this.value),this.visited++):1==this.visited&&(this.send(f.END),this.visited++)}}]),t}(f);e.exports={sources:{asList:a,just:u}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":o(e)},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(4),s=n(12),c=u.uuid,f=s.Immutable,l=function(){function e(t,n){if(r(this,e),f.isImmutable(t))this._immu=t;else if(t instanceof Error)this._immu=f.fromJS({__type__:"Signal",_seq:c.v1(),_cmd:n,_error:t,_end:!1,_payload:{},_tags:{}});else{"number"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t&&"undefined"!=typeof t&&null!==t||(t={__anon__:t});var o=c.v1(),a={},u=null,s=!1,l=t,p=n||null;"object"===("undefined"==typeof t?"undefined":i(t))&&(t.hasOwnProperty("_seq")&&(o=t._seq),t.hasOwnProperty("_tags")&&(a=t._tags),t.hasOwnProperty("_error")&&(u=t._error),t.hasOwnProperty("_end")&&(s=t._end),t.hasOwnProperty("_payload")&&(l=t._payload),t.hasOwnProperty("_cmd")&&(p=t._cmd)),this._immu=f.fromJS({__type__:"Signal",_seq:o,_cmd:p,_error:u,_end:s,_payload:l,_tags:a})}}return a(e,[{key:"toJSON",value:function(){return this._immu.toJSON()}},{key:"setFrom",value:function(e){return this._from.push(e),this}},{key:"new",value:function(t){var n=this.seq;return new e(t).setSeq(n).setTags(this.tags)}},{key:"get",value:function(e){var t=e;"string"==typeof e&&(t=e.split(".")),t.unshift("_payload");var n=this._immu.getIn(t);return f.readyToJS(n)?n.toJS():n}},{key:"set",value:function(t,n){var r=t;return"string"==typeof t&&(r=t.split(".")),r.unshift("_payload"),new e(this._immu.setIn(r,n))}},{key:"getAnonPayload",value:function(){return this.get("__anon__")}},{key:"setPayload",value:function(t){return"number"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t&&"undefined"!=typeof t&&null!==t||(t={__anon__:t}),new e(this._immu.set("_payload",t))}},{key:"getResult",value:function(){return this.get("__result__")}},{key:"setResult",value:function(e){return this.set("__result__",e)}},{key:"del",value:function(t){var n=t;return"string"==typeof t&&(n=t.split(".")),n.unshift("_payload"),new e(this._immu.deleteIn(n))}},{key:"setTags",value:function(t){return new e(this._immu.set("_tags",t))}},{key:"getTag",value:function(e){var t=this._immu.getIn(["_tags",e]);return f.readyToJS(t)?t.toJS():t}},{key:"getCmd",value:function(e){var t=e;"string"==typeof e&&(t=e.split(".")),t.unshift("_cmd");var n=this._immu.getIn(t);return f.readyToJS(n)?n.toJS():n}},{key:"setCmd",value:function(t,n){var r=t;return"string"==typeof t&&(r=t.split(".")),r.unshift("_cmd"),new e(this._immu.setIn(r,n))}},{key:"delCmd",value:function(t){var n=t;return"string"==typeof t&&(n=t.split(".")),n.unshift("_cmd"),new e(this._immu.deleteIn(n))}},{key:"setTag",value:function(t,n){return new e(this._immu.setIn(["_tags",t],n))}},{key:"delTag",value:function(t){return new e(this._immu.deleteIn(["_tags",t]))}},{key:"setSeq",value:function(t){return new e(this._immu.set("_seq",t))}},{key:"setError",value:function(t){return new e(this._immu.set("_error",t))}},{key:"setEnd",value:function(t){return new e(this._immu.set("_end",t))}},{key:"hasError",value:function(){return this.error instanceof Error}},{key:"isEnd",value:function(){return this.end}},{key:"__type__",get:function(){return this._immu.get("__type__")}},{key:"seq",get:function(){return this._immu.get("_seq")}},{key:"id",get:function(){return this._immu.get("_seq")}},{key:"payload",get:function(){var e=this._immu.get("_payload");return f.readyToJS(e)?e.toJS():e}},{key:"anonPayload",get:function(){return this.get("__anon__")}},{key:"error",get:function(){return this._immu.get("_error")}},{key:"end",get:function(){return this._immu.get("_end")}},{key:"tags",get:function(){var e=this._immu.get("_tags");return f.readyToJS(e)?e.toJS():e}},{key:"from",get:function(){return this._from}}],[{key:"isSignal",value:function(e){return"object"===("undefined"==typeof e?"undefined":i(e))&&"Signal"===e.__type__}},{key:"hasError",value:function(e){return"object"===("undefined"==typeof e?"undefined":i(e))&&e.error instanceof Error}},{key:"isEnd",value:function(e){return"object"===("undefined"==typeof e?"undefined":i(e))&&e.end}},{key:"Error",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(t){var n=t;return"string"==typeof t&&(n=new Error(t)),new e(t)})},{key:"End",value:function(){var t=new e;return t.setEnd(!0)}}]),e}();e.exports=l},function(e,t,n){"use strict";var r=n(13);e.exports={Immutable:r}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":o(e)},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(14),s=function(){function e(t){r(this,e),this.__type__="CollarImmutable",this.state=new u(t).get()}return a(e,[{key:"get",value:function(e){return this.state[e]}},{key:"getIn",value:function(e){for(var t="string"==typeof e?e.split("."):e,n=this.state,r=0;r<t.length;r++){if(!n.hasOwnProperty(t[r]))return null;n=n[t[r]]}return n}},{key:"set",value:function(t,n){var r=new u(this.state.toJS());return r.get().set(t,n),new e(r.get().toJS())}},{key:"setIn",value:function(t,n){
for(var r="string"==typeof t?t.split("."):t,o=new u(this.state.toJS()),a=o.get(),s=0;s<r.length;s++){if(a.hasOwnProperty(r[s]))if(s===r.length-1)a=a.set(r[s],n);else{var c=a[r[s]];c&&"object"===("undefined"==typeof c?"undefined":i(c))||(a=a.set(r[s],{}))}else a=s===r.length-1?a.set(r[s],n):a.set(r[s],{});a=a[r[s]]}return new e(o.get().toJS())}},{key:"deleteIn",value:function(t){for(var n="string"==typeof t?t.split("."):t,r=new u(this.state.toJS()),o=r.get(),i=0;i<n.length;i++)if(i<n.length-1){if(o=o[n[i]],null===o)return new e(this.freezer.get())}else o.remove(n[i]);return new e(r.get().toJS())}},{key:"toJSON",value:function(){return this.state.toJS()}}],[{key:"fromJS",value:function(t){return new e(t)}},{key:"isImmutable",value:function(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":i(e))&&"CollarImmutable"===e.__type__}},{key:"readyToJS",value:function(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":i(e))&&"Object"===e.constructor.name&&e.toJS}}]),e}();s.Iterable=function(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":i(e))&&"CollarImmutable"===e.__type__},e.exports=s},function(e,t){e.exports=n(14)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=null;return"string"==typeof e?o={comment:e,input:t,output:n,asActuator:r}:"string"!=typeof e&&(o={input:e,output:t,asActuator:n}),new p(o)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),f=100,l=1e4,p=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="delegator",i._inputDelegation=e.input,i._outputDelegation=e.output||e.input,i.addFeature("delegator"),e.asActuator?(i._asActuator=!0,i.addFeature("actuator")):(i._asActuator=!1,i.addFeature("processor")),i._receivedSignals=new Map,i._outputDelegation.observe(function(e,t,n){if("send"===t){if(i._receivedSignals.has(n.id)){var r=i._receivedSignals.get(n.id).signal;i._receivedSignals.delete(n.id),i._asActuator?n.error?i.send(r.setResult(n.payload).setError(n.error)):n.end?i.send(r.setResult(n.payload).setEnd(!0)):i.send(r.setResult(n.payload)):i.send(n)}i.checkExpiredSession()}}),i}return i(t,e),s(t,[{key:"onSignal",value:function(e){this._receivedSignals.set(e.id,{timestamp:(new Date).getTime(),signal:e}),this._inputDelegation.push(e)}},{key:"checkExpiredSession",value:function(){var e=this;this._receivedSignals.size>f&&!function(){var t=(new Date).getTime();Object.keys(e._receivedSignals).forEach(function(n){t<e._receivedSignals.get(n).timestamp+l&&e._receivedSignals.delete(n)})}()}}]),t}(c);e.exports={operators:{delegate:a},through:a}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){"function"==typeof e&&(t=e,e="sensor");var n={comment:e,fn:t};return n.fn||(n.todo=!0),new f(n)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),f=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="sensor",i.fn=e.fn||function(){},i.addFeature("sensor"),i.addFeature("active"),i.watch(i.options),i}return i(t,e),s(t,[{key:"watch",value:function(e){this.fn.call(this,e)}}]),t}(c);e.exports={sources:{sensor:a}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n,r){return new p(f.prepareNodeOptions(e,t,n,r,"filter"))}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),f=n(18),l=n(19),p=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="filter",i._comment||(i._comment="filter"),i.fn=function(t){var n=Object.prototype.hasOwnProperty.call(this.meta,"namespace")?this.meta.namespace+".":"",r=l.getFn(""+n+this.name);return r?r.call(this,t):!e.fn||e.fn.call(this,t)},i.addFeature("filter"),i}return i(t,e),s(t,[{key:"accept",value:function(e){return this.fn(e)}},{key:"onSignal",value:function(e){this.accept(e)?this.send(e):this.request()}}]),t}(c);e.exports={operators:{filter:a,when:a}}},function(e,t,n){"use strict";function r(e,t){return t._node_callbacks||(t._node_callbacks={}),e._to_node_funcs||(e._to_node_funcs={}),t._to_node_observer||(t._to_node_observer=function(e,n,r){if("send"===n){var o=r.getTag("__to_node_dest__");if(!o||o!==t.id)return;var i=t._node_callbacks[r.id];if(!i)return;delete t._node_callbacks[r.id],r.error?i(r.error,r.payload):i(null,r.payload)}},t.observe(t._to_node_observer)),Object.prototype.hasOwnProperty.call(e._to_node_funcs,t.id)?e._to_node_funcs[t.id]:(e._to_node_funcs[t.id]=function(n,r){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=n;o.isSignal(a)||(a=new o(n)),a=a.setTag("__to_node_dest__",t.id),t._node_callbacks[a.id]=r,e.push(a,i)},e._to_node_funcs[t.id])}var o=n(11);e.exports={prepareNodeOptions:function(e,t,n,r,o){return"function"==typeof e?o?{comment:o,fn:e}:{fn:e}:"function"==typeof t?{comment:e,fn:t}:"function"==typeof n?{comment:e,inputs:t,fn:n}:"function"==typeof r?{comment:e,inputs:t,outputs:n,fn:r}:r?{}:{comment:e,inputs:t,outputs:n,fn:r,todo:!0}},toNode:r}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e),this.registry={}}return r(e,[{key:"register",value:function(e,t,n){return this.registry[e]={type:t,fn:n},this}},{key:"registerActuatorSync",value:function(e,t){return this.register(e,"actuator.sync",t)}},{key:"registerActuatorAsync",value:function(e,t){return this.register(e,"actuator.async",t)}},{key:"registerProcessorSync",value:function(e,t){return this.register(e,"processor.sync",t)}},{key:"registerProcessorAsync",value:function(e,t){return this.register(e,"processor.async",t)}},{key:"registerFilter",value:function(e,t){return this.register(e,"filter",t)}},{key:"remove",value:function(e){Object.prototype.hasOwnProperty.call(this.registry,e)&&delete this.registry[e]}},{key:"clear",value:function(){this.registry={}}},{key:"get",value:function(e){return Object.prototype.hasOwnProperty.call(this.registry,e)?this.registry[e]:null}},{key:"getFn",value:function(e){return Object.prototype.hasOwnProperty.call(this.registry,e)?this.registry[e].fn:null}}]),e}(),i=null;e.exports=null==i?i=new o:i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n,r){return new h(l.prepareNodeOptions(e,t,n,r,"actuator"))}function u(e,t,n,r){return new y(l.prepareNodeOptions(e,t,n,r,"actuator"))}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(2),l=n(18),p=n(19),h=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="actuator",i.fn=function(t,n){var r=Object.prototype.hasOwnProperty.call(this.meta,"namespace")?this.meta.namespace+".":"",o=p.getFn(""+r+this.name);return o?o.call(this,t,n):e.fn?e.fn.call(this,t,n):void n()},i.addFeature("actuator"),i}return i(t,e),c(t,[{key:"act",value:function(e,t){this.fn.call(this,e,t)}},{key:"onSignal",value:function(e){var t=this;this.act(e,function(n,r){return n?void t.throwError(n,e):void(r||0===r||r===!1||""===r?t.send(e.set("__result__",r)):t.send(e))})}}]),t}(f),y=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="actuator.sync",i.fn=function(t){var n=Object.prototype.hasOwnProperty.call(this.meta,"namespace")?this.meta.namespace+".":"",r=p.getFn(""+n+this.name);return r?r.call(this,t):e.fn?e.fn.call(this,t):void 0},i.addFeature("actuator"),i}return i(t,e),c(t,[{key:"act",value:function(e,t){var n=this.fn.call(this,e);t(null,n)}},{key:"onSignal",value:function(e){var t=this;this.act(e,function(n,r){if(n)throw n;r||0===r||r===!1||""===r?t.send(e.set("__result__",r)):t.send(e)})}}]),t}(f);e.exports={operators:{actuator:a,actuatorSync:u,do:u},Actuator:h}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n,r){return new y(p.prepareNodeOptions(e,t,n,r,"processor"))}function u(e,t,n,r){return new d(p.prepareNodeOptions(e,t,n,r,"processor"))}function s(e,t,n,r){return new d(p.prepareNodeOptions(e,t,n,r,"map"))}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(2),p=n(18),h=n(19),y=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="processor",i.fn=function(t,n){var r=Object.prototype.hasOwnProperty.call(this.meta,"namespace")?this.meta.namespace+".":"",o=h.getFn(""+r+this.name);return o?o.call(this,t,n):e.fn?e.fn.call(this,t,n):void n(null,t)},i.addFeature("processor"),i.addFeature("async"),i}return i(t,e),f(t,[{key:"process",value:function(e,t){this.fn.call(this,e,t)}},{key:"onSignal",value:function(e){var t=this;this.process(e,function(n,r){n?t.throwError(n,e):t.send(r)})}}]),t}(l),d=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="processor.sync",i.fn=function(t){var n=Object.prototype.hasOwnProperty.call(this.meta,"namespace")?this.meta.namespace+".":"",r=h.getFn(""+n+this.name);return r?r.call(this,t):e.fn?e.fn.call(this,t):t},i.addFeature("processor"),i.addFeature("sync"),i}return i(t,e),f(t,[{key:"process",value:function(e,t){var n=this.fn.call(this,e);t(null,n)}},{key:"onSignal",value:function(e){var t=this;this.process(e,function(e,n){if(e)throw e;t.send(n)})}}]),t}(l);e.exports={operators:{processor:a,processorSync:u,map:s}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n,r){return new l(f.prepareNodeOptions(e,t,n,r,"error handler"))}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),f=n(18),l=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="errorhandler",i.fn=e.fn||function(e){},i.addFeature("errorhandler"),i}return i(t,e),s(t,[{key:"onError",value:function(e){var t=this;this.fn(e,function(e){t.send(e)})}}]),t}(c);e.exports={operators:{errors:a}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e&&console.error(new Error("endpoint must have a name")),t.mode="input",t.comment=e,new p(t)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e&&console.error(new Error("endpoint must have a name")),t.mode="output",t.comment=e,new p(t)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e&&console.error(new Error("endpoint must have a name")),t.comment=e,new p(t)}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(2),p=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return e.mode||(e.mode="input"),(!e.mode||"input"!==e.mode&&"output"!==e.mode)&&(console.warn("invalid endpoint mode [",e.mode,'], use "input" instead'),e.mode="input"),i._type="endpoint."+e.mode,i._name=i._comment,i.addFeature("endpoint"),i.addFeature(e.mode),i}return i(t,e),f(t,[{key:"accept",value:function(e){var t=this.options.filter||[];if(0===t.length)return!0;var n=!1,r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value;n=!0;for(var c in s)if(e.get(c)!==s[c]){n=!1;break}if(n)break}}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n&&this.invokeObservers("enter endpoint",e),n}},{key:"act",value:function(e,t){t(),this.invokeObservers("leave endpoint",e)}},{key:"preventMetaPropagation",value:function(){return"input"===this.options.mode}}]),t}(l);e.exports={sources:{endpoint:s,input:a,output:u}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){var n={comment:e,source:t};return Array.isArray(e)&&(n.comment=null,n.source=e),new h(n)}function u(e,t){var n={comment:e,source:t};return t||(n.comment=null,n.source=e),new y(n)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},l=n(2),p=n(11),h=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="passive",i.addFeature("passive"),i._comment=e.comment||"passive array source",i.source=e.source,i.index=0,i}return i(t,e),c(t,[{key:"onNext",value:function(){this.source.length===this.index?(this.send((new p).setEnd(!0)),this.index++):this.source.length>this.index&&(this.send(new p(this.source[this.index])),this.index++)}},{key:"send",value:function(e){p.isSignal(e)?f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,e.setCmd("mode","passive")):f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,new p(e,{mode:"passive"}))}}]),t}(l),y=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.addFeature("passive"),i._comment=e.comment||"passive array source",i.source=e.source,i.visited=0,i}return i(t,e),c(t,[{key:"onNext",value:function(){0===this.visited?(this.send(new p(this.source)),this.visited++):1===this.visited&&(this.send((new p).setEnd(!0)),this.visited++)}},{key:"send",value:function(e){p.isSignal(e)?f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,e.setCmd("mode","passive")):f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,new p(e,{mode:"passive"}))}}]),t}(l);e.exports={sources:{asList:a,just:u}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(){return new f}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),f=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="sink",i._comment="drive passive source",i}return i(t,e),s(t,[{key:"onSignal",value:function(){this.request()}},{key:"from",value:function(){this.request()}}]),t}(c);e.exports={operators:{sink:a}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n){return new l({comment:e,name:t,value:n})}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),f=n(27),l=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="variable",i._value=i.options.value||0==i.options.value?i.options.value:{},i._name=i.options.name,i._comment=i.options.comment||"var '"+i._name+"'",i.addFeature("variable"),i.addFeature("active"),i.inputs={value:"the new value"},i.outputs={type:"always be 'variableChanged'",value:"new value of the variable",before:"old value"},i}return i(t,e),s(t,[{key:"get",value:function(e){return f.get(this._value,e)}},{key:"set",value:function(e,t){if(!e||""===e)return void(this.value=t);var n=f.get(this._value,e);f.set(this._value,e,t),this.send({type:"variableChanged",value:this._value,before:n})}},{key:"onSignal",value:function(e){var t=e.get("value");this.value=t}},{key:"value",get:function(){return this._value},set:function(e){var t=this._value;this._value=e,this.send({type:"variableChanged",value:this._value,before:t})}}]),t}(c);e.exports={Variable:l,operators:{variable:a}}},function(e,t){e.exports=n(20)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n){return new l({comment:e,name:t,value:n})}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),f=n(27),l=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="model",i._value=i.options.value||0==i.options.value?i.options.value:{},i._name=i.options.name,i._comment=i.options.comment||'model "'+i._name+'"',i.addFeature("model"),i.addFeature("active"),i.addFeature("stateful"),i.inputs={operation:'one of "set", "insert", "append", and "delete"',path:"the path to make de operation, empty for root",index:'optional, only need for "insert"',value:'optional, only need for "set", "insert", and "append"'},i.outputs={type:'always be "modelChanged"',operation:'the operation that causes the change, one of "set", "insert", "append", and "delete"',path:"where does the change happen",value:"the value of the model",appended:"the appended value",index:"the position of the newly inserted value",inserted:"the inserted value",before:"old value of the changed part",after:"new value of the changed part"},i}return i(t,e),s(t,[{key:"get",value:function(e){return f.get(this._value,e)}},{key:"set",value:function(e,t,n){if(!e||""===e){var r=this._value;return this._value=t,void(n?this.send(n.new({type:"modelChanged",operation:"set",path:null,value:this._value,before:r,after:this._value})):this.send({type:"modelChanged",operation:"set",path:null,value:this._value,before:r,after:this._value}))}var o=f.get(this._value,e);f.set(this._value,e,t),n?this.send(n.new({type:"modelChanged",operation:"set",path:e,value:this._value,before:o,after:t})):this.send({type:"modelChanged",operation:"set",path:e,value:this._value,before:o,after:t})}},{key:"insert",value:function(e,t,n,r){var o=f.get(this._value,e);f.insert(this._value,e,t,n),r?this.send(r.new({type:"modelChanged",operation:"insert",path:e,index:n,value:this._value,inserted:t,before:o,after:f.get(this._value,e)})):this.send({type:"modelChanged",operation:"insert",path:e,index:n,value:this._value,inserted:t,before:o,after:f.get(this._value,e)})}},{key:"append",value:function(e,t,n){var r=this,o=f.get(this._value,e);Array.isArray(t)?t.forEach(function(t){f.push(r._value,e,t)}):f.push(this._value,e,t),n?this.send(n.new({type:"modelChanged",operation:"append",path:e,value:this._value,appended:t,before:o,after:f.get(this._value,e)})):this.send({type:"modelChanged",operation:"append",path:e,value:this._value,appended:t,before:o,after:f.get(this._value,e)})}},{key:"del",value:function(e,t){var n=f.get(this._value,e);f.del(this._value,e),t?this.send(t.new({type:"modelChanged",operation:"delete",path:e,value:this._value,before:n,after:null})):this.send({type:"modelChanged",operation:"delete",path:e,value:this._value,before:n,after:null})}},{key:"onSignal",value:function(e){var t=e.get("operation")||"set";if("set"===t){var n=e.get("path");this.set(n,e.get("value"),e)}else if("insert"===t){var n=e.get("path"),r=e.get("index");n&&null!=r&&void 0!=r&&this.insert(n,e.get("value"),r,e)}else if("append"===t){var n=e.get("path");n&&this.append(n,e.get("value"),e)}else if("delete"===t){var n=e.get("path");n&&this.del(n,e)}}},{key:"getState",value:function(e,t){t(null,this._value)}},{key:"value",get:function(){return this._value},set:function(e){var t=this._value;this._value=e,this.send({type:"modelChanged",operation:"set",path:null,value:this._value,before:t,after:this._value})}}]),t}(c);e.exports={sources:{model:a}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){var n={};return"string"!=typeof e?(n.comment="transport.outgoing",n.delegator=e):(n.comment=e,n.delegator=t),new v(n)}function u(e,t){var n={};return"string"!=typeof e?(n.comment="transport.incoming",n.delegator=e):(n.comment=e,n.delegator=t),new _(n)}function s(e,t){var n={};return"string"!=typeof e?(n.comment="transport.response",n.delegator=e):(n.comment=e,n.delegator=t),new m(n)}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(2),p=n(11),h=n(20),y=n(4).uuid,d=h.Actuator,v=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="transport.outgoing",i.delegator=e.delegator||{},
i.addFeature("async"),i.addFeature("transport"),i}return i(t,e),f(t,[{key:"act",value:function(e,t){return this.delegator.handleOutgoingSignal?this.delegator.handleOutgoingSignal(e,function(e,n){return e?t(e):t(null,n)}):t()}},{key:"getTransportId",value:function(){return this.delegator.getId?this.delegator.getId():y.v1()}}]),t}(d),_=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="transport.incoming",i.delegator=e.delegator||{},i.addFeature("sensor"),i.addFeature("active"),i.addFeature("async"),i.addFeature("transport"),i.watch(i.options),i}return i(t,e),f(t,[{key:"getTransportId",value:function(){return this.delegator.getId?this.delegator.getId():null}},{key:"watch",value:function(){var e=this;this.delegator.listen&&this.delegator.listen(function(t,n){var r=n;p.isSignal(n)||(r=new p(n)),e.delegator.saveContext(t,r),e.send(r)})}}]),t}(l),m=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="transport.response",i._cacheSize=e.cacheSize||20,i._cacheTimeout=e.cacheTimeout||5e3,i.delegator=e.delegator||{},i.addFeature("actuator"),i.addFeature("async"),i.addFeature("transport"),i.cache=new Map,i}return i(t,e),f(t,[{key:"getTransportId",value:function(){return this.delegator.getId?this.delegator.getId():null}},{key:"act",value:function(e,t){if(!this.delegator.handleResponseSignal)return t();var n=null;return n=this.delegator.getContext?n=this.delegator.getContext(e):null,this.delegator.handleResponseSignal(n,e,function(e,n){return e?t(e):t(null,n)})}},{key:"onError",value:function(e){var t=this;if(!this.delegator.handleResponseSignal)return this.send(e);var n=null;return n=this.delegator.getContext?n=this.delegator.getContext(e):null,this.delegator.handleResponseSignal(n,e,function(n,r){return n?t.send(e.setError(n)):void(r?t.send(e.setResult(r)):t.send(e))})}}]),t}(d);e.exports={OutgoingTransport:v,IncomingTransport:_,ResponseTransport:m,operators:{req:a,listen:u,resp:s}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){var n={};return n="number"==typeof e?{ms:t}:{comment:e,ms:t},new f(n)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),f=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="throttle",i.ms=e.ms,i._comment=e.comment||"throttle ("+i.ms+" ms)",i.last=(new Date).getTime(),i.addFeature("filter"),i}return i(t,e),s(t,[{key:"onSignal",value:function(e){var t=(new Date).getTime();t-this.ms>=this.last&&(this.last=t,this.send(e))}}]),t}(c);e.exports={operators:{throttle:a}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){var n={};return n=t?{comment:e,ref:t}:{comment:"go to "+e._comment,ref:e},new f(n)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),f=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._ref=e.ref,i._type="reference",i.addFeature("reference"),i.addFeature("actuator"),i}return i(t,e),s(t,[{key:"act",value:function(e,t){this._ref&&this._ref.push(e),t()}}]),t}(c);e.exports={operators:{ref:a}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e?t.comment=e:t=e,new l(t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},f=n(2),l=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="node",i.onSignalDelegate=i.options.onSignal,i.onErrorDelegate=i.options.onError,i.onEndDelegate=i.options.onEnd,i.watchDelegate=i.options.watch,i.acceptDelegate=i.options.accept,i.actDelegate=i.options.act,i.processDelegate=i.options.process,i.onNextDelegate=i.options.onNext,i.getStateDelegate=i.options.getState,i.getStateDelegate&&i.addFeature("stateful"),i.onErrorDelegate&&i.addFeature("errorhandler"),i.watchDelegate&&i.addFeature("sensor"),i.acceptDelegate&&i.addFeature("filter"),i.actDelegate&&i.addFeature("actuator"),i.processDelegate&&i.addFeature("processor"),i.addFeature("general"),i.addFeature("async"),i}return i(t,e),s(t,[{key:"onSignal",value:function(e){return this.onSignalDelegate?this.onSignalDelegate.call(this,e):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onSignal",this).call(this,e)}},{key:"onError",value:function(e){return this.onErrorDelegate?this.onErrorDelegate.call(this,e):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onError",this).call(this,e)}},{key:"onEnd",value:function(e){return this.onEndDelegate?this.onEndDelegate.call(this,e):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onEnd",this).call(this,e)}},{key:"watch",value:function(e){return this.watchDelegate?this.watchDelegate.call(this,e):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"watch",this).call(this,e)}},{key:"accept",value:function(e){return this.acceptDelegate?this.acceptDelegate.call(this,e):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"accept",this).call(this,e)}},{key:"act",value:function(e,n){return this.actDelegate?this.actDelegate.call(this,e,n):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"act",this).call(this,e,n)}},{key:"process",value:function(e,n){return this.processDelegate?this.processDelegate.call(this,e,n):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"process",this).call(this,e,n)}},{key:"getState",value:function(e,n){return this.getStateDelegate?this.getStateDelegate.call(this,e,n):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getState",this).call(this,e,n)}}]),t}(f);e.exports={operators:{node:a}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){var n={};return"string"==typeof e?(n.comment=e,n.isEndAtom=t):void 0===e||e===!0?(n.comment="start atom process",n.isEndAtom=!1):(n.comment="end atom process",n.isEndAtom=!0),new f(n)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),f=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="processor.sync",i.isEndAtom=e.isEndAtom,i.addFeature("atom"),i.addFeature("sync"),i}return i(t,e),s(t,[{key:"process",value:function(e,t){var n=null;n=this.isEndAtom?e.delTag("__non_interruptible__"):e.setTag("__non_interruptible__",!0),t(null,n)}},{key:"onSignal",value:function(e){var t=this;this.process(e,function(e,n){if(e)throw e;t.send(n)})}}]),t}(c);e.exports={operators:{atom:a}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){var n={};return"string"==typeof e?(n.comment=e,n.state=t):(n.comment="checkpoint",n.state=e),new l(n)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),f=n(19),l=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._type="checkpoint",i.addFeature("checkpoint"),i.addFeature("actuator"),i.addFeature("async"),i.addFeature("stateful"),i.stateFn=function(t,n){var r=Object.prototype.hasOwnProperty.call(i.meta,"namespace")?i.meta.namespace+".":"",o=f.getFn(""+r+i.name);return o?o.call(i,t,n):e.state?e.state.call(i,t,n):void n()},i}return i(t,e),s(t,[{key:"onSignal",value:function(e){this.send(e)}},{key:"getState",value:function(e,t){try{this.stateFn.call(this,e,t)}catch(e){console.error(e)}}}]),t}(c);e.exports={operators:{checkpoint:a}}}])})}).call(t,n(6).setImmediate)},function(e,t,n){function r(e,t){this._id=e,this._clearFn=t}var o=Function.prototype.apply;t.setTimeout=function(){return new r(o.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(o.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(7),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return d[y]=r,h(y),y++}function o(e){delete d[e]}function i(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(v)setTimeout(a,0,e);else{var t=d[e];if(t){v=!0;try{i(t)}finally{o(e),v=!1}}}}function u(){h=function(e){t.nextTick(function(){a(e)})}}function s(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function c(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),h=function(n){e.postMessage(t+n,"*")}}function f(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;a(t)},h=function(t){e.port2.postMessage(t)}}function l(){var e=_.documentElement;h=function(t){var n=_.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function p(){h=function(e){setTimeout(a,0,e)}}if(!e.setImmediate){var h,y=1,d={},v=!1,_=e.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(e);m=m&&m.setTimeout?m:e,"[object process]"==={}.toString.call(e.process)?u():s()?c():e.MessageChannel?f():_&&"onreadystatechange"in _.createElement("script")?l():p(),m.setImmediate=r,m.clearImmediate=o}}("undefined"==typeof self?"undefined"==typeof e?this:e:self)}).call(t,function(){return this}(),n(8))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(f===setTimeout)return setTimeout(e,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function i(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function a(){d&&h&&(d=!1,h.length?y=h.concat(y):v=-1,y.length&&u())}function u(){if(!d){var e=o(a);d=!0;for(var t=y.length;t;){for(h=y,y=[];++v<t;)h&&h[v].run();v=-1,t=y.length}h=null,d=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function c(){}var f,l,p=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(e){f=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}}();var h,y=[],d=!1,v=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];y.push(new s(e,t)),1!==y.length||d||o(u)},s.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,n){var r=n(10),o=n(13),i=o;i.v1=r,i.v4=o,e.exports=i},function(e,t,n){function r(e,t,n){var r=t&&n||0,o=t||[];e=e||{};var a=void 0!==e.clockseq?e.clockseq:s,l=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:f+1,h=l-c+(p-f)/1e4;if(h<0&&void 0===e.clockseq&&(a=a+1&16383),(h<0||l>c)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=l,f=p,s=a,l+=122192928e5;var y=(1e4*(268435455&l)+p)%4294967296;o[r++]=y>>>24&255,o[r++]=y>>>16&255,o[r++]=y>>>8&255,o[r++]=255&y;var d=l/4294967296*1e4&268435455;o[r++]=d>>>8&255,o[r++]=255&d,o[r++]=d>>>24&15|16,o[r++]=d>>>16&255,o[r++]=a>>>8|128,o[r++]=255&a;for(var v=e.node||u,_=0;_<6;++_)o[r+_]=v[_];return t?t:i(o)}var o=n(11),i=n(12),a=o(),u=[1|a[0],a[1],a[2],a[3],a[4],a[5]],s=16383&(a[6]<<8|a[7]),c=0,f=0;e.exports=r},function(e,t){(function(t){var n,r=t.crypto||t.msCrypto;if(r&&r.getRandomValues){var o=new Uint8Array(16);n=function(){return r.getRandomValues(o),o}}if(!n){var i=new Array(16);n=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}e.exports=n}).call(t,function(){return this}())},function(e,t){function n(e,t){var n=t||0,o=r;return o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]}for(var r=[],o=0;o<256;++o)r[o]=(o+256).toString(16).substr(1);e.exports=n},function(e,t,n){function r(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var u=0;u<16;++u)t[r+u]=a[u];return t||i(a)}var o=n(11),i=n(12);e.exports=r},function(e,t,n){var r=n(15);e.exports=r},function(e,t,n){"use strict";var r=n(16),o=(n(17),n(18)),i=function(e,t){var n,i=this,a=t||{},u={live:a.live||!1,freezeInstances:a.freezeInstances||!1},s=[],c=0,f=function(e){var t,n=e.__;if(n.listener){var r=n.listener.prevState||e;n.listener.prevState=0,o.trigger(r,"update",e,!0)}for(t=0;t<n.parents.length;t++)n.store.notify("now",n.parents[t])},l=function(e){s.push(e),c||(c=1,r.nextTick(function(){s=[],c=0}))};u.notify=function(e,t,n){if("now"==e){if(s.length)for(;s.length;)f(s.shift());else f(t);return t}var i=o[e](t,n);if("pivot"!=e){var a=r.findPivot(i);if(a)return l(i),a}return i},u.freezeFn=a.mutable===!0?function(){}:function(e){Object.freeze(e)},n=o.freeze(e,u),n.__.updateRoot=function(e,t){e===n&&(n=t)};var p=n.getListener(),h={};r.each(["on","off","once","trigger"],function(e){var t={};t[e]=p[e].bind(p),r.addNE(i,t),r.addNE(h,t)}),r.addNE(this,{get:function(){return n},set:function(e){n.reset(e)},getEventHub:function(){return h}}),r.addNE(this,{getData:this.get,setData:this.set})};e.exports=i},function(e,t){"use strict";var n=new Function("return this")(),r={extend:function(e,t){for(var n in t)e[n]=t[n];return e},createNonEnumerable:function(e,t){var n={};for(var r in e)n[r]={value:e[r]};return Object.create(t||{},n)},error:function(e){var t=new Error(e);if(console)return console.error(t);throw t},each:function(e,t){var n,r,o;if(e&&e.constructor==Array)for(n=0,r=e.length;n<r;n++)t(e[n],n);else for(o=Object.keys(e),n=0,r=o.length;n<r;n++)t(e[o[n]],o[n])},addNE:function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!1,configurable:!0,writable:!0,value:t[n]})},createNE:function(e){var t={};for(var n in e)t[n]={writable:!0,configurable:!0,enumerable:!1,value:e[n]};return t},nextTick:function(){function e(){for(;r=o.shift();)r();i=!1}function t(e){o.push(e),i||(i=!0,s())}var r,o=[],i=!1,a=!!n.postMessage&&"undefined"!=typeof Window&&n instanceof Window,u="nexttick",s=function(){return a?function(){n.postMessage(u,"*")}:function(){setTimeout(function(){c()},0)}}(),c=function(){return a?function(t){t.source===n&&t.data===u&&(t.stopPropagation(),e())}:e}();return a&&n.addEventListener("message",c,!0),t.removeListener=function(){n.removeEventListener("message",c,!0)},t}(),findPivot:function(e){if(e&&e.__){if(e.__.pivot)return e;for(var t,n=0,r=e.__.parents,o=0;!n&&o<r.length;)t=r[o],t.__.pivot&&(n=t),o++;if(n)return n;for(o=0;!n&&o<r.length;)n=this.findPivot(r[o]),o++;return n}},isLeaf:function(e,t){var n;return!e||!(n=e.constructor)||(t?n===String||n===Number||n===Boolean:n!=Object&&n!=Array)}};e.exports=r},function(e,t,n){"use strict";var r=n(16),o="beforeAll",i="afterAll",a=[o,i],u={on:function(e,t,n){var r=this._events[e]||[];return r.push({callback:t,once:n}),this._events[e]=r,this},once:function(e,t){return this.on(e,t,!0)},off:function(e,t){if("undefined"==typeof e)this._events={};else if("undefined"==typeof t)this._events[e]=[];else{var n,r=this._events[e]||[];for(n=r.length-1;n>=0;n--)r[n].callback===t&&r.splice(n,1)}return this},trigger:function(e){var t,n,r,u,s=[].slice.call(arguments,1),c=this._events[e]||[],f=[],l=a.indexOf(e)!=-1;for(l||this.trigger.apply(this,[o,e].concat(s)),t=0;t<c.length;t++)n=c[t],n.callback?u=n.callback.apply(this,s):n.once=!0,n.once&&f.push(t),void 0!==u&&(r=u);for(t=f.length-1;t>=0;t--)c.splice(f[t],1);return l||this.trigger.apply(this,[i,e].concat(s)),r}},s=r.createNonEnumerable(u);e.exports=s},function(e,t,n){"use strict";var r=n(16),o=n(19),i=n(17),a={freeze:function(e,t){if(e&&e.__)return e;var n=this,i=o.clone(e);return r.addNE(i,{__:{listener:!1,parents:[],store:t}}),r.each(e,function(e,o){r.isLeaf(e,t.freezeInstances)||(e=n.freeze(e,t)),e&&e.__&&n.addParent(e,i),i[o]=e}),t.freezeFn(i),i},merge:function(e,t){var n=e.__,o=n.trans,t=r.extend({},t);if(o){for(var i in t)o[i]=t[i];return e}var a,u,s,c=this,f=this.copyMeta(e),l=n.store;r.each(e,function(n,o){return s=n&&n.__,s&&c.removeParent(n,e),(a=t[o])?(r.isLeaf(a,l.freezeInstances)||(a=c.freeze(a,l)),a&&a.__&&c.addParent(a,f),delete t[o],void(f[o]=a)):(s&&c.addParent(n,f),f[o]=n)});for(u in t)a=t[u],r.isLeaf(a,l.freezeInstances)||(a=c.freeze(a,l)),a&&a.__&&c.addParent(a,f),f[u]=a;return n.store.freezeFn(f),this.refreshParents(e,f),f},replace:function(e,t){var n=this,o=e.__,i=t;return r.isLeaf(t,o.store.freezeInstances)||(i=n.freeze(t,o.store),i.__.parents=o.parents,i.__.updateRoot=o.updateRoot,o.listener&&(i.__.listener=o.listener)),i&&this.fixChildren(i,e),this.refreshParents(e,i),i},remove:function(e,t){var n=e.__.trans;if(n){for(var o=t.length-1;o>=0;o--)delete n[t[o]];return e}var i,a=this,u=this.copyMeta(e);return r.each(e,function(n,r){i=n&&n.__,i&&a.removeParent(n,e),t.indexOf(r)==-1&&(i&&a.addParent(n,u),u[r]=n)}),e.__.store.freezeFn(u),this.refreshParents(e,u),u},splice:function(e,t){var n=e.__,o=n.trans;if(o)return o.splice.apply(o,t),e;var i,a=this,u=this.copyMeta(e),s=t[0],c=s+t[1];if(r.each(e,function(t,n){t&&t.__&&(a.removeParent(t,e),(n<s||n>=c)&&a.addParent(t,u)),u[n]=t}),t.length>1)for(var f=t.length-1;f>=2;f--)i=t[f],r.isLeaf(i,n.store.freezeInstances)||(i=this.freeze(i,n.store)),i&&i.__&&this.addParent(i,u),t[f]=i;return Array.prototype.splice.apply(u,t),n.store.freezeFn(u),this.refreshParents(e,u),u},transact:function(e){var t,n=this,o=e.__.trans;return o?o:(t=e.constructor==Array?[]:{},r.each(e,function(e,n){t[n]=e}),e.__.trans=t,r.nextTick(function(){e.__.trans&&n.run(e)}),t)},run:function(e){var t=this,n=e.__.trans;if(!n)return e;r.each(n,function(n,r){n&&n.__&&t.removeParent(n,e)}),delete e.__.trans;var o=this.replace(e,n);return o},pivot:function(e){return e.__.pivot=1,this.unpivot(e),e},unpivot:function(e){r.nextTick(function(){e.__.pivot=0})},refresh:function(e,t,n){var o=this,i=e.__.trans,a=0;if(i)return r.each(i,function(r,u){a||r===t&&(i[u]=n,a=1,n&&n.__&&o.addParent(n,e))}),e;var u,s=this.copyMeta(e);r.each(e,function(r,i){r===t&&(r=n),r&&(u=r.__)&&(o.removeParent(r,e),o.addParent(r,s)),s[i]=r}),e.__.store.freezeFn(s),this.refreshParents(e,s)},fixChildren:function(e,t){var n=this;r.each(e,function(r){if(r&&r.__){if(n.fixChildren(r),1==r.__.parents.length)return r.__.parents=[e];t&&n.removeParent(r,t),n.addParent(r,e)}})},copyMeta:function(e){var t=o.clone(e),n=e.__;return r.addNE(t,{__:{store:n.store,updateRoot:n.updateRoot,listener:n.listener,parents:n.parents.slice(0),trans:n.trans,pivot:n.pivot}}),n.pivot&&this.unpivot(t),t},refreshParents:function(e,t){var n,r=e.__,o=r.parents.length;if(e.__.updateRoot&&e.__.updateRoot(e,t),t&&this.trigger(e,"update",t,r.store.live),o)for(n=o-1;n>=0;n--)this.refresh(r.parents[n],e,t)},removeParent:function(e,t){var n=e.__.parents,r=n.indexOf(t);r!=-1&&n.splice(r,1)},addParent:function(e,t){var n=e.__.parents,r=n.indexOf(t);r==-1&&(n[n.length]=t)},trigger:function(e,t,n,o){var i=e.__.listener;if(i){var a=i.ticking;if(o)return void((a||n)&&(i.ticking=0,i.trigger(t,a||n,e)));i.ticking=n,i.prevState||(i.prevState=e),a||r.nextTick(function(){if(i.ticking){var n=i.ticking;i.prevState;i.ticking=0,i.prevState=0,i.trigger(t,n,e)}})}},createListener:function(e){var t=e.__.listener;return t||(t=Object.create(i,{_events:{value:{},writable:!0}}),e.__.listener=t),t}};o.init(a),e.exports=a},function(e,t,n){"use strict";var r=n(16),o={init:function(e){var t={set:function(e,t){var n=e,o=this.__.trans;if("object"!=typeof e&&(n={},n[e]=t),!o){for(var i in n)o=o||this[i]!==n[i];if(!o)return r.findPivot(this)||this}return this.__.store.notify("merge",this,n)},reset:function(e){return this.__.store.notify("replace",this,e)},getListener:function(){return e.createListener(this)},toJS:function(){var e;return e=this.constructor==Array?new Array(this.length):{},r.each(this,function(t,n){t&&t.__?e[n]=t.toJS():e[n]=t}),e},transact:function(){return this.__.store.notify("transact",this)},run:function(){return this.__.store.notify("run",this)},now:function(){return this.__.store.notify("now",this)},pivot:function(){return this.__.store.notify("pivot",this)}},n=r.extend({push:function(e){return this.append([e])},append:function(e){return e&&e.length?this.__.store.notify("splice",this,[this.length,0].concat(e)):this},pop:function(){return this.length?this.__.store.notify("splice",this,[this.length-1,1]):this},unshift:function(e){return this.prepend([e])},prepend:function(e){return e&&e.length?this.__.store.notify("splice",this,[0,0].concat(e)):this},shift:function(){return this.length?this.__.store.notify("splice",this,[0,1]):this},splice:function(e,t,n){return this.__.store.notify("splice",this,arguments)}},t),o=Object.create(Array.prototype,r.createNE(n)),i=r.createNE(r.extend({remove:function(e){var t=[],n=e;e.constructor!=Array&&(n=[e]);for(var r=0,o=n.length;r<o;r++)this.hasOwnProperty(n[r])&&t.push(n[r]);return t.length?this.__.store.notify("remove",this,t):this}},t)),a=Object.create(Object.prototype,i),u=function(){return[].__proto__?function(e){var t=new Array(e);return t.__proto__=o,t}:function(e){var t=new Array(e);for(var r in n)t[r]=n[r];return t}}();this.clone=function(e){var t=e.constructor;return t==Array?u(e.length):t===Object?Object.create(a):Object.create(t.prototype,i)}}};e.exports=o},function(e,t,n){var r,o,i;!function(n,a){"use strict";"object"==typeof e&&"object"==typeof e.exports?e.exports=a():(o=[],r=a,i="function"==typeof r?r.apply(t,o):r,!(void 0!==i&&(e.exports=i)))}(this,function(){"use strict";function e(e,t){return null!=e&&Object.prototype.hasOwnProperty.call(e,t)}function t(t){if(!t)return!0;if(s(t)&&0===t.length)return!0;if("string"!=typeof t){for(var n in t)if(e(t,n))return!1;return!0}return!1}function n(e){return u.call(e)}function r(e){return"object"==typeof e&&"[object Object]"===n(e)}function o(e){return"boolean"==typeof e||"[object Boolean]"===n(e)}function i(e){var t=parseInt(e);return t.toString()===e?t:e}function a(n){function a(t,r){return n.includeInheritedProps||"number"==typeof r&&Array.isArray(t)||e(t,r)}function u(e,t){if(a(e,t))return e[t]}function c(e,t,n,r){if("number"==typeof t&&(t=[t]),!t||0===t.length)return e;if("string"==typeof t)return c(e,t.split(".").map(i),n,r);var o=t[0],a=u(e,o);return 1===t.length?(void 0!==a&&r||(e[o]=n),a):(void 0===a&&("number"==typeof t[1]?e[o]=[]:e[o]={}),c(e[o],t.slice(1),n,r))}n=n||{};var f=function(e){return Object.keys(f).reduce(function(t,n){return"create"===n?t:("function"==typeof f[n]&&(t[n]=f[n].bind(f,e)),t)},{})};return f.has=function(t,r){if("number"==typeof r?r=[r]:"string"==typeof r&&(r=r.split(".")),!r||0===r.length)return!!t;for(var o=0;o<r.length;o++){var a=i(r[o]);if(!("number"==typeof a&&s(t)&&a<t.length||(n.includeInheritedProps?a in Object(t):e(t,a))))return!1;t=t[a]}return!0},f.ensureExists=function(e,t,n){return c(e,t,n,!0)},f.set=function(e,t,n,r){return c(e,t,n,r)},f.insert=function(e,t,n,r){var o=f.get(e,t);r=~~r,s(o)||(o=[],f.set(e,t,o)),o.splice(r,0,n)},f.empty=function(e,n){if(!t(n)&&null!=e){var i,u;if(i=f.get(e,n)){if("string"==typeof i)return f.set(e,n,"");if(o(i))return f.set(e,n,!1);if("number"==typeof i)return f.set(e,n,0);if(s(i))i.length=0;else{if(!r(i))return f.set(e,n,null);for(u in i)a(i,u)&&delete i[u]}}}},f.push=function(e,t){var n=f.get(e,t);s(n)||(n=[],f.set(e,t,n)),n.push.apply(n,Array.prototype.slice.call(arguments,2))},f.coalesce=function(e,t,n){for(var r,o=0,i=t.length;o<i;o++)if(void 0!==(r=f.get(e,t[o])))return r;return n},f.get=function(e,t,n){if("number"==typeof t&&(t=[t]),!t||0===t.length)return e;if(null==e)return n;if("string"==typeof t)return f.get(e,t.split("."),n);var r=i(t[0]),o=u(e,r);return void 0===o?n:1===t.length?o:f.get(e[r],t.slice(1),n)},f.del=function(e,n){if("number"==typeof n&&(n=[n]),null==e)return e;if(t(n))return e;if("string"==typeof n)return f.del(e,n.split("."));var r=i(n[0]);return a(e,r)?1!==n.length?f.del(e[r],n.slice(1)):(s(e)?e.splice(r,1):delete e[r],e):e},f}var u=Object.prototype.toString,s=Array.isArray||function(e){return"[object Array]"===u.call(e)},c=a();return c.create=a,c.withInheritedProps=a({includeInheritedProps:!0}),c})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={MSG_TYPE:"msgType",ACTION_TYPE:"actionType",MSG_RENDER:"render",MSG_STATE_CHANGED:"state changed",ACTION_GET_STATE:"GET_STATE",ACTION_SET_STATE:"SET_STATE",ACTION_INITIATE:"INITIATE",ACTION_RENDER:"RENDER",KEY_ROUTE:"route",KEY_URL:"url",KEY_STATE:"state",STATE_SYS:"sys",STATE_ROUTE:"route",STATE_PARSED_URL:"parsedURL",STATE_URL:"url"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){for(var t=a.default.get(e),n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.apply(void 0,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(23),a=r(i)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(24),u=r(a),s=n(32),c=r(s),f=function(){
function e(){o(this,e),this._archs=new Map}return i(e,[{key:"register",value:function(e,t){this._archs.set(e,t)}},{key:"get",value:function(e){return this._archs.get(e)}}]),e}(),l=new f;l.register("redux-single-route-app",function(e,t){return new u.default(e,t)}),l.register("redux-multiple-routes-app",function(e,t){return new c.default(e,t)}),t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(25),p=r(l),h=n(21),y=r(h),d=n(2),v=r(d),_=n(26),m=r(_),b=n(28),g=r(b),w=n(29),S=r(w),O=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n._sysComponent=n.createComponent("system"),n._appSensor=n._sysComponent.ns().sensor("app sensor",function(){}),n.view=new g.default({getName:function(){return"view"},render:e.render,updateState:e.updateState}),n.store=new m.default({getName:function(){return"store"},initState:e.initState});var r=n._appSensor,u=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),c(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(e),0===e.button&&(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||e.defaultPrevented!==!0&&(e.preventDefault(),this.props.to?(S.default.redirect(this.props.to),r.send({actionType:"RENDER",url:this.props.to})):console.log(e.currentTarget.pathname,e.currentTarget.search)))}},{key:"render",value:function(){var e=this.props.props;return p.default.createElement("a",s({href:this.props.to},e,{onClick:this.handleClick.bind(this)}),this.props.children)}}]),t}(p.default.Component);return n.Link=u,n}return a(t,e),c(t,[{key:"getAppSensor",value:function(){return this._appSensor}},{key:"getViewSensor",value:function(){return this.view.sensor()}},{key:"setStore",value:function(e){this.store=e}},{key:"setView",value:function(e){this.view=e}},{key:"setRenderer",value:function(e){this.view.setRenderer(e)}},{key:"setViewStateUpdater",value:function(e){this.view.setStateUpdater(e)}},{key:"setStoreStateInitiator",value:function(e,t){this.store.setStateInitiator(e,t)}},{key:"reduce",value:function(){var e;return(e=this.store).reduce.apply(e,arguments)}},{key:"getCurrentLocation",value:function(){if("undefined"==typeof window)return console.warn("Window Object does not exist!"),null;var e=window.location,t=e.pathname,n=e.search,r=e.hash,o=t+n+r,i=S.default.base();return i&&(o=0===o.indexOf(i)?o.substr(i.length):o),o}},{key:"initComponents",value:function(){this.addComponent(this.view),this.addComponent(this.store),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initComponents",this).call(this)}},{key:"connectComponents",value:function(){this.store.output().to(this.view.input()),this.view.sensor().to(this.store.input()),this.getAppSensor().to(this.store.input())}},{key:"startComponents",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"startComponents",this).call(this),this.getAppSensor().send({actionType:y.default.ACTION_INITIATE},!1)}},{key:"run",value:function(){for(var e,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];(e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"run",this)).call.apply(e,[this].concat(r))}}]),t}(v.default);t.default=O},function(e,t){e.exports=React},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(27),c=r(s),f=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._state=null,n.setStateGetter(function(){return this._state}),n.setStateSetter(function(e){this._state=e}),n}return a(t,e),t}(c.default);t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(21),f=r(c),l=n(3),p=r(l),h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=e.getName?e.getName():t.getNextDefaultStoreName(),r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.options=e,r._isGetStateAsync=!!e.getStateAsync,r._isSetStateAsync=!!e.setStateAsync,r._isInitStateAsync=!!e.initStateAsync,r._isSaveInitStateAsync=!!e.saveInitStateAsync,r._syncStateGetter=e.getState,r._asyncStateGetter=e.getStateAsync,r._syncStateSetter=e.setState,r._asyncStateSetter=e.setStateAsync,r._syncStateInitiator=e.initState,r._asyncStateInitiator=e.initStateAsync,r._syncInitStateSaver=e.saveInitState,r._asyncInitStateSaver=e.saveInitStateAsync,r._reduceCounter=0,r._unnamedNodeCounter=0,r._prepareStateChanged=r.ns().map("prepare [state changed]",{__result__:"the new store state object"},{msgType:"[state changed]",state:"the new store state object"},function(e){return e.new({msgType:f.default.MSG_STATE_CHANGED,state:e.getResult()})}),r._saveStatePipeline=null,r._errorhandler=r.ns().errors(function(e){console.log(e.error)}),r}return a(t,e),s(t,[{key:"init",value:function(){this._errorhandler.to(this.output()),this.input().when(f.default.ACTION_INITIATE,function(e){return e.get(f.default.ACTION_TYPE)===f.default.ACTION_INITIATE}).to(this.initStateActuator()).map("@reducer_"+f.default.ACTION_INITIATE+" reduce",{__result__:"the previous state object"},{state:"the new state obejct"},function(e){var t=e.getResult();return t||(t={}),t[f.default.STATE_SYS]={},e.set(f.default.KEY_STATE,t)}).to(this.initStateSaver()).map("prepare [render]",function(e){return e.set(f.default.MSG_TYPE,f.default.MSG_RENDER).set(f.default.KEY_STATE,e.getResult()).del(f.default.KEY_URL).del(f.default.ACTION_TYPE).del("__result__")}).to(this._errorhandler),this.input().when(f.default.ACTION_RENDER,function(e){return e.get(f.default.ACTION_TYPE)===f.default.ACTION_RENDER}).to(this.getStateActuator(f.default.ACTION_RENDER)).map("@reducer_"+f.default.ACTION_INITIATE+" reduce",{__result__:"the previous state object"},{state:"the new state obejct"},function(e){var t=e.get(f.default.KEY_URL),n=e.getResult();return n[f.default.STATE_SYS][f.default.STATE_URL]=t,e.set(f.default.KEY_STATE,n)}).to(this.setStateActuator(f.default.ACTION_RENDER)).map("prepare [render]",function(e){return e.set(f.default.MSG_TYPE,f.default.MSG_RENDER).set(f.default.KEY_STATE,e.getResult()).del(f.default.KEY_URL).del(f.default.ACTION_TYPE).del("__result__")}).to(this._errorhandler)}},{key:"setStateSetter",value:function(e,t){this._isSetStateAsync=t,t?this._asyncStateSetter=e:this._syncStateSetter=e}},{key:"setStateGetter",value:function(e,t){this._isGetStateAsync=t,t?this._asyncStateGetter=e:this._syncStateGetter=e}},{key:"setStateInitiator",value:function(e,t){this._isInitStateAsync=t,t?this._asyncStateInitiator=e:this._syncStateInitiator=e}},{key:"setInitStateSaver",value:function(e,t){this._isSaveInitStateAsync=t,t?this._asyncInitStateSaver=e:this._syncInitStateSaver=e}},{key:"initStateSaver",value:function(){var e=this;return this._asyncInitStateSaver||this._syncInitStateSaver?this.ns().actuator("@initStateSaver init state save",{__result__:"the init state object"},{__result__:"the saved state object"},function(t,n){try{var r=t.get(f.default.KEY_STATE);if(!e._isSaveInitStateAsync)return e._syncInitStateSaver.call(e,r),n(null,r);e._asyncInitStateSaver.call(e,r,n)}catch(e){return n(e)}}):this.setStateActuator(f.default.ACTION_INITIATE)}},{key:"initStateActuator",value:function(e){var t=this,n=this.ns().actuator("@initState state initiator",{any:"parameter"},{__result__:"initial state"},function(e,n){try{if(!t._asyncStateInitiator&&!t._syncStateInitiator)return n();if(!t._isInitStateAsync){var r=t._syncStateInitiator.call(t);return n(null,r)}t._asyncStateInitiator.call(t,n)}catch(e){return n(e)}});return this._asyncStateInitiator||this._syncStateInitiator?n.removeFeature("todo").addFeature("impl"):n.removeFeature("impl").addFeature("todo"),n}},{key:"getStateActuator",value:function(e){var t=this,n=e?"getState_"+e:"getState_"+this._unnamedNodeCounter++,r=this.ns().actuator("@"+n+" state getter",{},{__result__:"the current state object"},function(e,n){try{if(!t._asyncStateGetter&&!t._syncStateGetter)return n();if(!t._isGetStateAsync){var r=t._syncStateGetter.call(t);return n(null,r)}t._asyncStateGetter.call(t,n)}catch(e){return n(e)}});return this._asyncStateGetter||this._syncStateGetter?r.removeFeature("todo").addFeature("impl"):r.removeFeature("impl").addFeature("todo"),r}},{key:"setStateActuator",value:function(e){var t=this,n=e?"setState_"+e:"setState_"+this._unnamedNodeCounter++,r=this.ns().actuator("@"+n+" state setter",{state:"the new state object"},{__result__:"the saved state object"},function(e,n){try{var r=e.get(f.default.KEY_STATE);if(!t._asyncStateSetter&&!t._syncStateSetter)return n(null,r);if(null===r||void 0===r)return n(new Error("state could NOT be null or undefined! Maybe setup a state initiator before starting the app?"));if(!t._isSetStateAsync)return t._syncStateSetter.call(t,r),n(null,r);t._asyncStateSetter.call(t,r,n)}catch(e){return n(e)}});return this._asyncStateSetter||this._syncStateSetter?r.removeFeature("todo").addFeature("impl"):r.removeFeature("impl").addFeature("todo"),r}},{key:"notifyStoreChangedActuator",value:function(){return this._prepareStoreChanged}},{key:"reduce",value:function(e,t){0==this._reduceCounter&&(this._prepareStateChanged.to(this._errorhandler),this._saveStatePipeline=this.setStateActuator(e),this._saveStatePipeline.to(this._prepareStateChanged)),this._reduceCounter++,this.input().when(e,function(t){return t.get(f.default.ACTION_TYPE)===e}).to("state getter",this.getStateActuator(e)).map("@reducer_"+e+" reduce",{__result__:"the previous state object"},{state:"the new state obejct"},function(e){var n=e.getResult(),r=t(n,e.payload);return e.new({state:r})}).to(this._saveStatePipeline)}},{key:"reduceAsync",value:function(e,t){0==this._reduceCounter&&(this._prepareStateChanged.to(this._errorhandler),this._saveStatePipeline=this.setStateActuator(e),this._saveStatePipeline.to(this._prepareStateChanged)),this._reduceCounter++,this.input().when(e,function(t){return t.get(f.default.ACTION_TYPE)===e}).to("state getter",this.getStateActuator(e)).processor("@reducer_"+e+" reduce",{__result__:"the previous state object"},{state:"the new state obejct"},function(e,n){var r=e.getResult();t(r,e.payload,function(t,r){return t?n(t):void n(null,e.new({state:r}))})}).to("state setter",this.setStateActuator(e)).to(this._prepareStateChanged)}}],[{key:"getNextDefaultStoreName",value:function(){return t.__COUNT__++,"store_"+t.__COUNT__}}]),t}(p.default);h.__COUNT__=0,t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(21),f=r(c),l=n(3),p=r(l),h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=e.getName?e.getName():t.getNextDefaultViewName(),r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.options=e,r._renderer=e.render,r._stateUpdater=e.updateState,r._sensor=r.ns().sensor(r.name+" sensor",function(){}),r._sensor.dispatch=function(e){return r._sensor.send(e,!1)},r._errorhandler=r.ns().errors(function(e){console.error(e.error)}),r}return a(t,e),s(t,[{key:"init",value:function(){this._errorhandler.to(this.output()),this.input().when(f.default.MSG_RENDER,{msgType:"must be [render]"},function(e){return e.get(f.default.MSG_TYPE)===f.default.MSG_RENDER}).to(this.getRendererActuator()).to(this.getUpdateStateActuator()).to(this._errorhandler),this.input().when(f.default.MSG_STATE_CHANGED,{msgType:"must be [state changed]",state:"the new state object"},function(e){return e.get(f.default.MSG_TYPE)===f.default.MSG_STATE_CHANGED}).to(this.getUpdateStateActuator()).to(this._errorhandler)}},{key:"start",value:function(){}},{key:"sensor",value:function(){return this._sensor}},{key:"render",value:function(e){return this._renderer?void this._renderer.call(this,e):void console.error("No renderer specified in view:",this.name)}},{key:"updateState",value:function(e){return this._stateUpdater?void this._stateUpdater.call(this,e):void console.error("No stateUpdater specified in view:",this.name)}},{key:"setRenderer",value:function(e){this._renderer=e}},{key:"setStateUpdater",value:function(e){this._stateUpdater=e}},{key:"getUpdateStateActuator",value:function(){var e=this,t=this.ns().actuator("view state updator",function(t,n){try{if(!e._stateUpdater)return n();e.updateState(t.get(f.default.KEY_STATE)),n()}catch(e){return n(e)}});return this._stateUpdater?t.removeFeature("todo").addFeature("impl"):t.removeFeature("impl").addFeature("todo"),t}},{key:"getRendererActuator",value:function(){var e=this,t=this.ns().actuator("renderer",function(t,n){try{if(!e._renderer)return n();e.render(t.get(f.default.KEY_STATE)),n()}catch(e){return n(e)}});return this._renderer?t.removeFeature("todo").addFeature("impl"):t.removeFeature("impl").addFeature("todo"),t}}],[{key:"getNextDefaultViewName",value:function(){return t.__COUNT__++,"view_"+t.__COUNT__}}]),t}(p.default);h.__COUNT__=0,t.default=h},function(e,t,n){(function(t){"use strict";function r(e,t){if("function"==typeof e)return r("*",e);if("function"==typeof t)for(var n=new u(e),o=1;o<arguments.length;++o)r.callbacks.push(n.middleware(arguments[o]));else"string"==typeof e?r["string"==typeof t?"redirect":"show"](e,t):r.start(e)}function o(e){if(!e.handled){var t;t=b?m+d.hash.replace("#!",""):d.pathname+d.search,t!==e.canonicalPath&&(r.stop(),e.handled=!1,d.href=e.canonicalPath)}}function i(e){return"string"!=typeof e?e:_?decodeURIComponent(e.replace(/\+/g," ")):e}function a(e,t){"/"===e[0]&&0!==e.indexOf(m)&&(e=m+(b?"#!":"")+e);var n=e.indexOf("?");if(this.canonicalPath=e,this.path=e.replace(m,"")||"/",b&&(this.path=this.path.replace("#!","")||"/"),this.title=document.title,this.state=t||{},this.state.path=e,this.querystring=~n?i(e.slice(n+1)):"",this.pathname=i(~n?e.slice(0,n):e),this.params={},this.hash="",!b){if(!~this.path.indexOf("#"))return;var r=this.path.split("#");this.path=r[0],this.hash=i(r[1])||"",this.querystring=this.querystring.split("#")[0]}}function u(e,t){t=t||{},this.path="*"===e?"(.*)":e,this.method="GET",this.regexp=l(this.path,this.keys=[],t)}function s(e){if(1===c(e)&&!(e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){for(var n=e.path?e.path[0]:e.target;n&&"A"!==n.nodeName;)n=n.parentNode;if(n&&"A"===n.nodeName&&!n.hasAttribute("download")&&"external"!==n.getAttribute("rel")){var o=n.getAttribute("href");if((b||n.pathname!==d.pathname||!n.hash&&"#"!==o)&&!(o&&o.indexOf("mailto:")>-1)&&!n.target&&f(n.href)){var i=n.pathname+n.search+(n.hash||"");"undefined"!=typeof t&&i.match(/^\/[a-zA-Z]:\//)&&(i=i.replace(/^\/[a-zA-Z]:\//,"/"));var a=i;0===i.indexOf(m)&&(i=i.substr(m.length)),b&&(i=i.replace("#!","")),m&&a===i||(e.preventDefault(),r.show(a))}}}}function c(e){return e=e||window.event,null===e.which?e.button:e.which}function f(e){var t=d.protocol+"//"+d.hostname;return d.port&&(t+=":"+d.port),e&&0===e.indexOf(t)}var l=n(30);e.exports=r;var p,h,y="undefined"!=typeof document&&document.ontouchstart?"touchstart":"click",d="undefined"!=typeof window&&(window.history.location||window.location),v=!0,_=!0,m="",b=!1;r.callbacks=[],r.exits=[],r.current="",r.len=0,r.base=function(e){return 0===arguments.length?m:void(m=e)},r.start=function(e){if(e=e||{},!p&&(p=!0,!1===e.dispatch&&(v=!1),!1===e.decodeURLComponents&&(_=!1),!1!==e.popstate&&window.addEventListener("popstate",g,!1),!1!==e.click&&document.addEventListener(y,s,!1),!0===e.hashbang&&(b=!0),v)){var t=b&&~d.hash.indexOf("#!")?d.hash.substr(2)+d.search:d.pathname+d.search+d.hash;r.replace(t,null,!0,v)}},r.stop=function(){p&&(r.current="",r.len=0,p=!1,document.removeEventListener(y,s,!1),window.removeEventListener("popstate",g,!1))},r.show=function(e,t,n,o){var i=new a(e,t);return r.current=i.path,!1!==n&&r.dispatch(i),!1!==i.handled&&!1!==o&&i.pushState(),i},r.back=function(e,t){r.len>0?(history.back(),r.len--):e?setTimeout(function(){r.show(e,t)}):setTimeout(function(){r.show(m,t)})},r.redirect=function(e,t){"string"==typeof e&&"string"==typeof t&&r(e,function(e){setTimeout(function(){r.replace(t)},0)}),"string"==typeof e&&"undefined"==typeof t&&setTimeout(function(){r.replace(e)},0)},r.replace=function(e,t,n,o){var i=new a(e,t);return r.current=i.path,i.init=n,i.save(),!1!==o&&r.dispatch(i),i},r.dispatch=function(e){function t(){var e=r.exits[u++];return e?void e(i,t):n()}function n(){var t=r.callbacks[a++];return e.path!==r.current?void(e.handled=!1):t?void t(e,n):o(e)}var i=h,a=0,u=0;h=e,i?t():n()},r.exit=function(e,t){if("function"==typeof e)return r.exit("*",e);for(var n=new u(e),o=1;o<arguments.length;++o)r.exits.push(n.middleware(arguments[o]))},r.Context=a,a.prototype.pushState=function(){r.len++,history.pushState(this.state,this.title,b&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},a.prototype.save=function(){history.replaceState(this.state,this.title,b&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},r.Route=u,u.prototype.middleware=function(e){var t=this;return function(n,r){return t.match(n.path,n.params)?e(n,r):void r()}},u.prototype.match=function(e,t){var n=this.keys,r=e.indexOf("?"),o=~r?e.slice(0,r):e,a=this.regexp.exec(decodeURIComponent(o));if(!a)return!1;for(var u=1,s=a.length;u<s;++u){var c=n[u-1],f=i(a[u]);void 0===f&&hasOwnProperty.call(t,c.name)||(t[c.name]=f)}return!0};var g=function(){var e=!1;if("undefined"!=typeof window)return"complete"===document.readyState?e=!0:window.addEventListener("load",function(){setTimeout(function(){e=!0},0)}),function(t){if(e)if(t.state){var n=t.state.path;r.replace(n,t.state)}else r.show(d.pathname+d.hash,void 0,void 0,!1)}}();r.sameOrigin=f}).call(t,n(8))},function(e,t,n){function r(e){for(var t,n=[],r=0,o=0,i="";null!=(t=v.exec(e));){var a=t[0],s=t[1],c=t.index;if(i+=e.slice(o,c),o=c+a.length,s)i+=s[1];else{i&&(n.push(i),i="");var f=t[2],l=t[3],p=t[4],h=t[5],y=t[6],d=t[7],_="+"===y||"*"===y,m="?"===y||"*"===y,b=f||"/",g=p||h||(d?".*":"[^"+b+"]+?");n.push({name:l||r++,prefix:f||"",delimiter:b,optional:m,repeat:_,pattern:u(g)})}}return o<e.length&&(i+=e.substr(o)),i&&n.push(i),n}function o(e){return i(r(e))}function i(e){for(var t=new Array(e.length),n=0;n<e.length;n++)"object"==typeof e[n]&&(t[n]=new RegExp("^"+e[n].pattern+"$"));return function(n){for(var r="",o=n||{},i=0;i<e.length;i++){var a=e[i];if("string"!=typeof a){var u,s=o[a.name];if(null==s){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to be defined')}if(d(s)){if(!a.repeat)throw new TypeError('Expected "'+a.name+'" to not repeat, but received "'+s+'"');if(0===s.length){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var c=0;c<s.length;c++){if(u=encodeURIComponent(s[c]),!t[i].test(u))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'", but received "'+u+'"');r+=(0===c?a.prefix:a.delimiter)+u}}else{if(u=encodeURIComponent(s),!t[i].test(u))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but received "'+u+'"');r+=a.prefix+u}}else r+=a}return r}}function a(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function u(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function s(e,t){return e.keys=t,e}function c(e){return e.sensitive?"":"i"}function f(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return s(e,t)}function l(e,t,n){for(var r=[],o=0;o<e.length;o++)r.push(y(e[o],t,n).source);var i=new RegExp("(?:"+r.join("|")+")",c(n));return s(i,t)}function p(e,t,n){for(var o=r(e),i=h(o,n),a=0;a<o.length;a++)"string"!=typeof o[a]&&t.push(o[a]);return s(i,t)}function h(e,t){t=t||{};for(var n=t.strict,r=t.end!==!1,o="",i=e[e.length-1],u="string"==typeof i&&/\/$/.test(i),s=0;s<e.length;s++){var f=e[s];if("string"==typeof f)o+=a(f);else{var l=a(f.prefix),p=f.pattern;f.repeat&&(p+="(?:"+l+p+")*"),p=f.optional?l?"(?:"+l+"("+p+"))?":"("+p+")?":l+"("+p+")",o+=p}}return n||(o=(u?o.slice(0,-2):o)+"(?:\\/(?=$))?"),o+=r?"$":n&&u?"":"(?=\\/|$)",new RegExp("^"+o,c(t))}function y(e,t,n){return t=t||[],d(t)?n||(n={}):(n=t,t=[]),e instanceof RegExp?f(e,t,n):d(e)?l(e,t,n):p(e,t,n)}var d=n(31);e.exports=y,e.exports.parse=r,e.exports.compile=o,e.exports.tokensToFunction=i,e.exports.tokensToRegExp=h;var v=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g")},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},f=n(21),l=(r(f),n(2)),p=(r(l),n(33)),h=r(p),y=n(34),d=r(y),v=n(24),_=r(v),m=n(35),b=r(m),g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.view=new h.default({getName:function(){return"view"}}),n.middleware=new d.default,n.use("router",b.default),n}return a(t,e),s(t,[{key:"route",value:function(e,t){this.view.addPage(e,t)}},{key:"setDefaultRoute",value:function(e){this.view.setDefaultRoute(e)}},{key:"setRootPath",value:function(e){this.view.setRootPath(e)}},{key:"redirect",value:function(e){this.view.redirect(e)}},{key:"use",value:function(e,t){return this.middleware.use(e,t),this}},{key:"initComponents",value:function(){this.addComponent(this.view),this.addComponent(this.store),this.addComponent(this.middleware),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initComponents",this).call(this)}},{key:"connectComponents",value:function(){this.store.output().to(this.middleware.input()),this.middleware.output().to(this.view.input()),this.view.sensor().to(this.store.input()),this.getAppSensor().to(this.store.input())}},{key:"startComponents",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"startComponents",this).call(this)}}]),t}(_.default);t.default=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(4),f=r(c),l=n(21),p=r(l),h=n(3),y=r(h),d=n(29),v=r(d),_=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=e.getName?e.getName():ViewComponent.getNextDefaultViewName(),r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.options=e,r._pages=new Map,r._routeList=[],r._defaultRoute="/",r._sensor=r.ns().sensor(r.name+" sensor",function(){}),r._routeDispatcher=r.ns().do("match route",function(e){var t=e.get(p.default.KEY_STATE),n=t[p.default.STATE_SYS][p.default.STATE_URL],o=r._defaultRoute;if(n){var i=!0,a=!1,u=void 0;try{for(var s,c=r._routeList[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var f=s.value;if(f.matcher.match(n,{})){o=f.route;break}}}catch(e){a=!0,u=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw u}}}return e.get(p.default.MSG_TYPE)===p.default.MSG_RENDER&&v.default.redirect(o),o}),r}return a(t,e),s(t,[{key:"init",value:function(){var e=this;this.input().to(this._routeDispatcher);var t=!0,n=!1,r=void 0;try{for(var o,i=function(){var t=o.value,n=(e._pages.get(t),e.name+"."+t),r=f.default.ns(n,{arch:n}),i=r.input("page input"),a=r.output("page output"),u=r.actuator("page state updator",function(n,r){try{e._pages.get(t).updateState(n.get(p.default.KEY_STATE)),r()}catch(e){return r(e)}});u.errors(function(e){console.error(e.error)}).to(a).to(e.output()),i.when(p.default.MSG_RENDER,{msgType:"must be [render]"},function(e){return e.get(p.default.MSG_TYPE)===p.default.MSG_RENDER}).do("renderer",function(n){var r=n.get(p.default.KEY_STATE);e._pages.get(t).render(r)}).to(u),i.when(p.default.MSG_STATE_CHANGED,{msgType:"must be [state changed]",state:"the new state object"},function(e){return e.get(p.default.MSG_TYPE)===p.default.MSG_STATE_CHANGED}).to(u),e._routeDispatcher.when(t,function(e){return e.getResult()===t}).to(i)},a=this._pages.keys()[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)i()}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}},{key:"addPage",value:function(e,t){this._pages.set(e,t),this._routeList.push({route:e,matcher:new v.default.Route(e)})}},{key:"setDefaultRoute",value:function(e){this._defaultRoute=e}},{key:"setRootPath",value:function(e){v.default.base(e)}},{key:"redirect",value:function(e){this._sensor.send({actionType:p.default.ACTION_RENDER,url:e},!1)}},{key:"start",value:function(){}},{key:"sensor",value:function(){return this._sensor}}],[{key:"getNextDefaultViewName",value:function(){return t.__COUNT__++,"view_"+ViewComponent.__COUNT__}}]),t}(y.default);_.__COUNT__=0,t.default=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");
}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(21),f=(r(c),n(3)),l=r(f),p=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"middlewares"));return e._middlewares=[],e}return a(t,e),s(t,[{key:"use",value:function(e,t,n){return this._middlewares.push({name:e,fn:t,async:n}),this}},{key:"init",value:function(){var e=this.input(),t=!0,n=!1,r=void 0;try{for(var o,i=function(){var t=o.value;e=t.async?e.processor(t.name,function(e,n){try{t.fn(e.payload,function(t){n(null,e.new(t))})}catch(e){n(e)}}):e.map(t.name,function(e){var n=t.fn(e.payload);return e.new(n)})},a=this._middlewares[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)i()}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}e.errors(function(e){console.error(e.error)}).to(this.output())}},{key:"start",value:function(){}}]),t}(l.default);t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e[a.default.MSG_TYPE],n=e[a.default.KEY_STATE],r=n[a.default.STATE_SYS][a.default.STATE_URL];t===a.default.MSG_RENDER&&(c=r?r:c);var o=!1;r!=c&&(c=r,o=!0);var i=(0,s.default)(c,!0);return n[a.default.STATE_SYS][a.default.STATE_PARSED_URL]=i,o&&(e[a.default.MSG_TYPE]=a.default.MSG_RENDER),e[a.default.KEY_STATE]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(21),a=r(i),u=n(36),s=r(u),c=null},function(e,t,n){"use strict";function r(e){var t=c.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function o(e,t){for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,o=n[r-1],i=!1,a=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),a++):a&&(0===r&&(i=!0),n.splice(r,1),a--);return i&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}function i(e,t,n){if(!(this instanceof i))return new i(e,t,n);var c,l,p,h,y,d,v=f.slice(),_=typeof t,m=this,b=0;for("object"!==_&&"string"!==_&&(n=t,t=null),n&&"function"!=typeof n&&(n=s.parse),t=u(t),l=r(e||""),c=!l.protocol&&!l.slashes,m.slashes=l.slashes||c&&t.slashes,m.protocol=l.protocol||t.protocol||"",e=l.rest,l.slashes||(v[2]=[/(.*)/,"pathname"]);b<v.length;b++)h=v[b],p=h[0],d=h[1],p!==p?m[d]=e:"string"==typeof p?~(y=e.indexOf(p))&&("number"==typeof h[2]?(m[d]=e.slice(0,y),e=e.slice(y+h[2])):(m[d]=e.slice(y),e=e.slice(0,y))):(y=p.exec(e))&&(m[d]=y[1],e=e.slice(0,y.index)),m[d]=m[d]||(c&&h[3]?t[d]||"":""),h[4]&&(m[d]=m[d].toLowerCase());n&&(m.query=n(m.query)),c&&t.slashes&&"/"!==m.pathname.charAt(0)&&(""!==m.pathname||""!==t.pathname)&&(m.pathname=o(m.pathname,t.pathname)),a(m.port,m.protocol)||(m.host=m.hostname,m.port=""),m.username=m.password="",m.auth&&(h=m.auth.split(":"),m.username=h[0]||"",m.password=h[1]||""),m.origin=m.protocol&&m.host&&"file:"!==m.protocol?m.protocol+"//"+m.host:"null",m.href=m.toString()}var a=n(37),u=n(38),s=n(39),c=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,f=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]];i.prototype.set=function(e,t,n){var r=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||s.parse)(t)),r[e]=t;break;case"port":r[e]=t,a(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,/:\d+$/.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!n;break;case"pathname":r.pathname=t.length&&"/"!==t.charAt(0)?"/"+t:t;break;default:r[e]=t}for(var o=0;o<f.length;o++){var i=f[o];i[4]&&(r[i[1]]=r[i[1]].toLowerCase())}return r.origin=r.protocol&&r.host&&"file:"!==r.protocol?r.protocol+"//"+r.host:"null",r.href=r.toString(),r},i.prototype.toString=function(e){e&&"function"==typeof e||(e=s.stringify);var t,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var o=r+(n.slashes?"//":"");return n.username&&(o+=n.username,n.password&&(o+=":"+n.password),o+="@"),o+=n.host+n.pathname,t="object"==typeof n.query?e(n.query):n.query,t&&(o+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(o+=n.hash),o},i.extractProtocol=r,i.location=u,i.qs=s,e.exports=i},function(e,t){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},function(e,t,n){(function(t){"use strict";var r,o=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,i={hash:1,query:1};e.exports=function(e){e=e||t.location||{},r=r||n(36);var a,u={},s=typeof e;if("blob:"===e.protocol)u=new r(unescape(e.pathname),{});else if("string"===s){u=new r(e,{});for(a in i)delete u[a]}else if("object"===s){for(a in e)a in i||(u[a]=e[a]);void 0===u.slashes&&(u.slashes=o.test(e.href))}return u}}).call(t,function(){return this}())},function(e,t){"use strict";function n(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,r={};t=n.exec(e);r[decodeURIComponent(t[1])]=decodeURIComponent(t[2]));return r}function r(e,t){t=t||"";var n=[];"string"!=typeof t&&(t="?");for(var r in e)o.call(e,r)&&n.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return n.length?t+n.join("&"):""}var o=Object.prototype.hasOwnProperty;t.stringify=r,t.parse=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(25),l=r(f),p=n(29),h=r(p),y=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),c(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(e),0===e.button&&(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||e.defaultPrevented!==!0&&(e.preventDefault(),this.props.to?(h.default.redirect(this.props.to),this.props.sensor.send({actionType:"RENDER",url:this.props.to})):console.log(e.currentTarget.pathname,e.currentTarget.search)))}},{key:"render",value:function(){var e=this.props.props;return l.default.createElement("a",s({href:this.props.to},e,{onClick:this.handleClick.bind(this)}),this.props.children)}}]),t}(l.default.Component);t.default=y}]);